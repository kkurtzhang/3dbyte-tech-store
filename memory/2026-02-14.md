# 2026-02-14

## Task Board Rules (Learned)
- Always have ONE BACKLOG section
- Always have ONE IN PROGRESS section  
- Move BACKLOG → IN PROGRESS first, then spawn sub-agent
- After task complete: move to COMPLETED, spawn next task
- Never create duplicate sections
- Only ONE sub-agent at a time

## Sub-Agents Summary
- @Pixel: All frontend tasks completed (45+)
- @Merchant: Checkout API blocked - billing errors

## API Key Resolution
- Issue was NOT .env.local - that file doesn't exist
- Real API key `pk_02d0df7032093e813cfad67fe27d10c1c3130797c0ec2e17eefe6f880da5382c` is in `/apps/storefront-v3/.env`
- Backend API verified working - returns 103 products (Cheese_18, Chips_27, etc.)
- Frontend needs restart to pick up .env changes

## Frontend Verification Results (CORRECTED)
- **Products page**: ✅ Uses real Medusa API (sdk.store.product.list)
- **Cart page**: ✅ Uses real Medusa API (sdk.store.cart.*)
- **Checkout page**: ✅ Uses real Medusa API (completeCart, initiatePaymentSession)
- Backend API works (103 products)
- Earlier "mock data" reports were WRONG - all connections are real

## Solution for Strapi 404 Build Errors
- Created hybrid pages that try Strapi first, then fallback to static content
- Files: /returns, /privacy-policy, /shipping, /terms-and-conditions
- Pattern: wrap Strapi fetch in try/catch, use fallback string if error
- Prevents build failures when Strapi content missing

## Pages Created (Feb 14)
- /about - company info, mission, team (static)
- /contact - contact form, info (static)
- /blog - coming soon placeholder (static)
- Plus 4 hybrid pages with Strapi + fallback

## Storefront Port
- Dev server runs on **port 3001** (not 3000)
- `pnpm run dev --turbopack -p 3001`

## Heartbeat Frequencies (from config)
- Main agent: 30m heartbeat
- Architect (me): 15m heartbeat

## Visual Testing Done
- Used playwright-cli to visually test storefront pages
- Found 7 broken footer links (# URLs instead of real pages)
- Found 3 missing pages: /docs, /guides, /community (404)
- Created 5 new backlog tasks for fixes

## Backlog Updated
- Added: Fix Footer Broken Links, Create Docs/Guides/Community/Help Center pages
- Total backlog: 6 tasks

## Sub-Agents Spawned (All Completed)
- @Pixel: Footer fix → ✅
- @Sentinel: Performance audit → ✅
- @Pixel: Create /docs page → ✅
- @Pixel: Create /guides page → ✅
- @Pixel: Create /community page → ✅
- @Pixel: Create /help page → ✅
- @Sentinel: Audit & Visual Test → ✅ (found critical 404s)

## Git Commit
- Committed 71 files (7956 insertions) to feat/storefront-v3-core-features

## Audit Findings
- Critical 404s: /cart, /shop, /products/[id], /checkout
- Working: /, /wishlist, /account, /docs, /guides, /community, /faq, /returns
- Product images use emoji placeholders
- No "Add to Cart" button on product cards

## Task Board Rules (Learned)
- Always have ONE BACKLOG section
- Always have ONE IN PROGRESS section
- Move BACKLOG → IN PROGRESS first, then spawn sub-agent
- After task complete: move to COMPLETED, spawn next task
- Never create duplicate sections

## Sub-Agents Today
- @Sentinel: Audit → found critical 404s
- @Pixel: Cart Page → ✅
- @Pixel: Product Details → ✅
- @Pixel: Checkout Page → ✅
- @Pixel: Product Images → Next.js Image
- @Pixel: Add to Cart → Cart Context + button
- @Merchant: Cart API → Already implemented
- @Merchant: Product Details API → Connected (needs publishable key)
- @Merchant: Products Listing API → Connected (needs publishable key)
- @Merchant: Checkout API → 5+ attempts failed - API billing error (zai provider)
- @Merchant: Multiple retries stuck at exploration phase

## API Issues Summary
- zai/glm-4.7 billing error on all attempts
- Default model also fails
- Tasks stuck at exploration phase - don't complete implementation
- Need to find way to get actual implementation done

## Integration Summary
- Cart, Products, Checkout connected to Medusa API
- Need: Valid publishable API key for production
- Issue: API key ran out of credits - 3 checkout attempts all failed with billing error

## Lessons Learned
- Always check sub-agent reports for next steps
- Include self-test instructions when Spawning
- Use fallback models when primary fails
- Check API key credits/billing when tasks fail

## API Issues
- All @Merchant tasks use zai/glm-4.7 model
- 4 attempts to connect Checkout all failed with billing error
- GLM-2 fallback also failed - same issue
- zai provider needs credits topped up

## Kurt Instructions
- Always read sub-agent reports for next steps/improvements
- Include self-test instructions when spawning sub-agents
- Check pages for mock data before marking complete

## Kurt Instructions
- Always read sub-agent reports for next steps/improvements
- Include self-test instructions when spawning sub-agents
- Claude CLI sometimes hangs in sub-agents - may need fallback

## Claude CLI Rule
- Updated HEARTBEAT.md to require claude CLI in spawn commands
- Verified sub-agents follow rule via session transcripts ✅
- One sub-agent had CLI hang (no output) - fell back to standard tools

## Agent-to-Agent Config
- Kurt asked about enabling agent-to-agent history
- Config: agents.tools.agentToAgent.enabled + allowlist

## Kurt Notes
- Kurt confirmed Architect can use fallback models when primary runs low
- Added to MEMORY.md
- **Audit tasks should NOT use Claude CLI** - use browser + grep only
